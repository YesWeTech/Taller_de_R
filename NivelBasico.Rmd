---
title: "Nivel Basico"
author: "Geek and Tech Girls"
date: "17 de abril de 2017"
output: rmarkdown::github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Tutorial b√°sico sobre R

Al terminar este tutorial tendr√°s unas nociones b√°sicas de R y podr√°s:

* Instalar paquetes nuevos en R
* Crear un script de R
* Hacer operaciones b√°sicas
* Utilizar distintos tipos de datos simples
* Crear vectores y vectores-factores
* Conocer los dataframes de R

## R Studio

En este taller utilizaremos R Studio. Consulta el [README](https://github.com/geekandtechgirls/Taller_de_R/blob/master/README.md) para saber m√°s sobre c√≥mo instalarlo. La interfaz de R Studio es as√≠:

![](imgs/interfaz_R_studio.png)

Como ves, puedes ir escribiendo los comandos directamente en la l√≠nea de comandos, pero tambi√©n puedes hacer un _script_ (un archivo con varios comandos juntos). Para ello nos vamos arriba a la izquierda: ![](imgs/new_file.png).

Adem√°s de _scripts_, podemos crear otros tipos de archivos como un _R notebook_ o _R markdown_, como los tutoriales del taller.

Para ejecutar las l√≠neas del _script_ podemos usar _Run_ o hacer _Ctrl+Intro_.

Para a√±adir comentarios, utiliza la almohadilla: #.

### Instalando paquetes nuevos

Para instalar paquetes nuevos en R, tenemos dos opciones: 

* Usar el comando
```r
install.packages('nombre_del_paquete')
```
* Usar el gestor de paquetes (pesta√±a _Packages -> Install_)

![](imgs/instalar_paquete.png)

TambiÈn podemos instalar paquetes nuevos desde la lÌnea de comandos de la siguiente manera:

```{r}
install.packages('nombre_del_paquete', dependencies = TRUE)
```

Cuando instalamos un paquete nuevo y lo queremos usar, se lo decimos a R de la siguiente manera:

```{r}
require(nombre_del_paquete)
```

### Ejercicio
__Instala el paquete 'knitr', muy √∫til para realizar documentos con cÛdigo de R incrustado, como este tutorial.__

```{r}
```

## Aritm√©tica con R

Antes de operar sobre grandes cantidades de datos o usar estructuras de datos complejas, es bueno que nos familiaricemos m√°s con la interfaz de R.

### Asignaci√≥n de variables

En R podemos trabajar directamente con los datos o guardarlos en variables, para as√≠ poder tenerlos disponibles en todo momento y trabajar con ellos. El operador de asignaci√≥n es __<-__. Por ejemplo:

```{r}
x <- 10
```

Si nos fijamos a la derecha, nos aparece la variable creada:
![](imgs/var_x.png)

Y para visualizar variables, lo √∫nico que tenemos que hacer es _llamarlas_:

```{r}
x
```

As√≠, podemos ponerle nombre a cualquier operaci√≥n, adem√°s de a funciones. Ten siempre en cuenta que debes usar nombres de variables adecuados para que tu c√≥digo siempre sea legible. 

### Operadores

Los operadores num√©ricos b√°sicos de R son:

Operador | S√≠mbolo
-------- | -------
Suma     | +
Resta    | - 
Multiplicaci√≥n | *
Divisi√≥n | /
Potencias | ^ o **
M√≥dulo | %%

Por ejemplo:

```{r}
1+2
```

O usando variables:

```{r}
edad_Nathan <- 6
edad_Fausto <- 5
edad_Kimi <- 1
edad_gatos <- edad_Nathan + edad_Fausto + edad_Kimi
edad_gatos
```

### Ejercicio

La se√±ora de los gatos de los Simpson(TM) tiene 7 gatos, de edades:

Nombre | Edad
------ | ----
Misif√∫ | 8
Blanquito | 5 
Garfield | 1
Isis | 9
Trece | 6
Ner√≥n | 3
Don Gato | 3

__Calcula la media de edad de los gatetes.__

```{r}
```

### Ejercicio

(De https://www.smartick.es/blog/index.php/problemas-con-potencias/)
La Hidra de Lerna es un personaje mitol√≥gico que aparece en algunas historias, como la de las 12 pruebas de H√©rcules. La Hidra era un monstruo con 1 cabeza, pero si se le cortaba, le nac√≠an 2 cabezas en su lugar. Si un h√©roe intentaba vencerla cort√°ndole todas sus cabezas cada d√≠a, ¬øcu√°ntas cabezas tendr√≠a la Hidra el tercer d√≠a? ¬øy al cabo de 10 d√≠as intentando vencerla?

__Hazlo con y sin potencias.__

```{r}
```

## Tipos de datos

Al igual que todos los lenguajes de programaci√≥n, _R_ trabaja los tipos de datos b√°sicos:

* __Numeric__: n√∫meros decimales.
* __Integer__: n√∫meros enteros. Para diferenciarlos de los numeric, se coloca una `L` al final de n√∫mero.
* __Logical__: valores booleanos. En _R_, los valores booleanos son `TRUE` y `FALSE` aunque tambi√©n se acepta `T` y `F`.
* __Character__: texto (_string_).

Para saber el tipo de una variable, se usa la funci√≥n `class`:

```{r}
class(5.6)
class(5L)
class(T)
class(TRUE)
class("TRUE")
```

### Ejercicio
__Prueba a declarar una variable con un n√∫mero decimal, pero poni√©ndole la `L` que se pone al declarar n√∫meros enteros ¬øqu√© pasa?__

```{r}
```

### Ejercicio
__Declara un entero sin la `L` al final y comprueba su tipo, ¬øqu√© tipo de variable es?__

```{r}
```

## Vectores y factores

### Declaraci√≥n de un vector

En _R_, podemos decir que todo elemento que hagamos, ser√° un vector o _array_, con una longitud determinada, en la que almacenaramos informaci√≥n. Esta informaci√≥n que almacenamos pueden ser datos de tipo _int_, _char_, etc.  Un vector lo crearemos con la funci√≥n _combine_ `c()` . En esta funci√≥n introduciremos los datos que queremos almacenar en nuestro array uno detr√°s de otro, separados por una coma.

```{r}
dado <- c(1, 2, 3, 4, 5, 6)
letras <- c("a", "b", "c", "d", "e", "f")
```

#### Ejercicio

Este a√±o has tenido la suerte de que te has ido a las Vegas y has decidido jugar y apostar en el poker y la ruleta. Durante estos cinco  d√≠as que llevas de vacaciones tus ingresos y p√©rdidas han sido:

* Lunes: has ganado 150$.
* Martes: has ganado 5$.
* Mi√©rcoles: has perdido 75$.
* Jueves: has perdido 128$ (vaya racha).
* Viernes: has ganado 15$.

Y en el caso de la ruleta:

* Lunes: has perdido 35$.
* Martes: has ganado 40$.
* Mi√©rcoles: has perdido 165$.
* Jueves: has ganado 12$ (vaya racha).
* Viernes: has ganado 178$.

Como tu futuro econ√≥mico parece incierto, has decido usar tus recientemente adquiridas capacidades en R para analizar estos datos y usar tus habilidades estad√≠sticas para decidir si apostar o no en el futuro. Para ello, empieza introduciendo estos datos en  dos vectores.

```{r}

```

### Asignar nombres a un vector

Adem√°s de crear un vector con datos, en muchos casos, como es en la ciencia de datos, es importante saber qu√© es cada dato o qu√© representan los datos de un vector. Esto es muy f√°cil y c√≥modo de hacer con la funci√≥n `names()`. Esta funci√≥n recibe como argumento nuestro reci√©n y estrenado array y se le asigna un nuevo array que contiene los nombres que queremos asignarle a nuestros datos almacenados. Un ejemplo es el siguiente:

```{r}
un_plato <- c("Magdalenas", "Dulce")
elementos <- c("SSD", "Nuevo")

names(un_plato) <- c("Nombre", "Tipo")
names(elementos) <- c("Elemento", "Estado")
```

#### Ejercicio

Asigna nombres a los elementos de los vectores de cantidades que ganaste cada dÌa de la semana.

```{r}
```

### Operaciones con arrays y otras funciones

Al igual que se pueden realizar operaciones aritm√©ticas con variables, esto tambi√©n es posible realizarlo con nuestros arrays. Hay que tener en cuenta, que estas operaciones se hacen elemento a elemento. Por ejemplo:

```{r}
a <- c(1,2,3)
b <- c(4,5,6)

cat("* Suma:", a+b)
cat("* Resta:", a-b)
cat("* Multiplicaci√≥n:", a*b)
cat("* Divisi√≥n:", a/b)
```

A su vez, tambi√©n podemos realizar operaciones booleanas con arrays, utilizando los operadores `<`, `>`, `==`, etc. Estas operaciones no tienen por qu√© ser solo con arrays, sino que podemos comparar un array con un entero por ejemplo, y la operaci√≥n booleana se aplica elemento a elemento con el entero con el que estamos comparando. Comprueba las relaciones que hay entre a y b:

```{r}

```

Adem√°s de esto, R nos ofrece otras funciones ya predefinidas que se encargan de calcular la sumatoria de un vector, como es el caso de la funci√≥n `sum`; el producto de los elementos de un vector, en este caso es `prod`; la media, para la cual llamaremos a `mean`, etc. Adem√°s de funciones como `max` o `min`.

#### Ejercicio

Siguiendo con el estudio para asegurar tu futuro econ√≥mico, es importante saber en qu√© d√≠a ganaste o perdiste dinero. Puesto que ya le has asignado a cada valor el d√≠a de la semana correspondiente, es importante saber la p√©rdida o ganancia total que has tenido cada d√≠a, as√≠ como la media total de ganancias durante tus vacaciones y lo que has ganado en total a lo largo de la semana. Para ello, utiliza los conocimientos adquiridos y tus habilidades estad√≠sticas, y no olvides mostrar tus datos por pantalla.

```{r}

```

### Acceso a un vector

Al igual que en muchos otros lenguajes, podemos acceder a los elementos del vector por el √≠ndice de la posici√≥n que ocupa el elemento en el vector. Como vemos en el siguiente ejemplo:

```{r}
mis_dulces <- c("chocolate", "tortas", "magdalenas", "brownie")
mis_dulces[2]
```

Pero existe una peque√±a diferencia frente a otros lenguajes, y es que los √≠ndices no empiezan desde el 0, sino desde el 1. Es por eso por lo que al acceder al elemento 2 en el vector anterior, nos devuelve `tortas` en vez de `magdalenas`.

A la hora de recorrerlo, podemos hacerlo con un bucle `for` al igual que har√≠amos en Python, C++, entre otros. Esta soluci√≥n es totalmente v√°lida, pero, en caso de que queramos aplicar la misma operaci√≥n a muchos elementos del vector, esto aumenta mucho los tiempos de c√°lculo. Por esto, R nos ofrece una soluci√≥n que se conoce como el "_acceso vectorizado_", que consiste en acceder a todos los elementos a la misma vez en una sola l√≠nea, por decirlo de una forma sencilla. 

En el siguiente ejemplo, vamos a multiplicar por dos, los 10 primeros elementos de nuestra serie.

```{r}
serie <- seq(1, 100)
serie[seq(1, 10)] = serie[seq(1, 10)]*2
```

Esto es un ejemplo de si queremos acceder por el √≠ndice. Tambi√©n, podemos acceder a los elementos del vector que cumplan una determinada condici√≥n, por ejemplo, obtener de un vector todos los elementos pares de este.

```{r}
serie <- seq(1, 20)
serie[serie %% 2 == 0]
```

O incluso acceder s√≥lo a ciertos √≠ndices:

```{r}
serie[5:10]
serie[c(1, 3, 6)]
```


#### Ejercicio

Tambi√©n podemos acceder a los elementos del vector por el nombre que tengan sus elementos. Por ello, prueba a acceder a las ganancias que has tenido el lunes y el viernes, para ver la suerte que has tenido al empezar tu semana de vacaciones y al terminarla.

```{r}

```

#### Ejercicio

Para comprobar que el acceso vectorizado es m√°s r√°pido que con un bucle `for`, con el acceso vectorizado al vector para sumarle uno a los elementos pares del vector.

```{r}
serie <- seq(1, 1000)

inicio <- Sys.time() # AsÌ medimos el tiempo
for(i in 1:1000) {
  if(serie[i] %% 2 == 0){
   serie[i] = serie[i] + 1 
  }
}
fin <- Sys.time()
cat("Tiempo: ", fin - inicio, "s.")

serie <- seq(1, 1000)

inicio <- Sys.time()
# Pon tu c√≥digo aqu√≠

fin <- Sys.time()
cat("Tiempo: ", fin - inicio, "s.")
```

## Matrices

Las ___matrices___ son elementos que almacenan datos de cualquier tipo, en una estructura con un n√∫mero de filas y columnas determinado. En R, podemos crear matrices con la funci√≥n `matrix`.

```{r}
mi_matriz_por_filas <- matrix(1:9, byrow = T, nrow = 3)
mi_matriz_por_filas
```
```{r}
mi_matriz_por_columnas <- matrix(1:9, byrow = F, nrow = 3)
mi_matriz_por_columnas
```

Otra forma de crear una matriz, es a partir de un vector que contenga la informaci√≥n que queremos representar en forma de matriz, como es el siguiente caso:

```{r}
v_info_1 <- c(5466.5, 246)
v_info_2 <- c(456, -567)
v_info_3 <- c(3249783, 596894)

info <- c(v_info_1, v_info_2, v_info_3)

matriz <- matrix(info, byrow = T, nrow = 3)
matriz
```

### Asignar nombres a una matriz

Al igual que pasaba con los vectores, podemos ponerle nombres a nuestra matriz, pero en este caso, en vez de nombrar elemento a elemento, podemos ponerle nombre a las filas y las columnas de la matriz, para que acceder a ellas sea m√°s c√≥modo. Para ello, podemos usar las funciones `rownames(tu_matriz)` y `colnames(tu_matriz)`.

#### Ejercicio

Genera una matriz de tama√±o $2\times4$ a partir de una secuencia de enteros, y nombra las filas y las columnas.

```{r}

```

### A√±adir filas y columnas a una matriz

Una vez definida una matriz, siempre es posible a√±adir una columna nueva o una nueva fila en caso de que nos haga falta. Ambas cosas son muy sencillas puesto que R ofrece dos funciones para realizar esta tarea, `cbind` para a√±adir una columna y `rbind` para a√±adir una fila a nuestra matriz. 

La √∫nica restricci√≥n que tienen estas funciones, es que tienen que tener el mismo n√∫mero de elementos que la matriz, es decir, que si la matriz tiene cuatro columnas y vamos a a√±adir una fila, esta fila debe tener cuatro elementos. Lo mismo pasa con a la hora de a√±adir una columna.

#### Ejercicio

A√±ade a la matriz anterior una nueva columna y una nueva fila.

```{r}

```

### Acceder a los elementos de una matriz

El acceso a los elementos de una matriz en R, es tan secillo como el acceder a los elementos en un array como has visto anteriormente. Al igual que antes, puedes acceder elemento a elemento a base de bucles `for` ([pincha aqu√≠](https://media.giphy.com/media/vPN3zK9dNL236/giphy.gif)), pero, lo m√°s eficiente es acceder de forma vectorizada a los elementos que queremos acceder.

* Acceder a un elemento en concreto.
```{r}
mi_matriz <- matrix(seq(1,100), byrow = T, nrow = 10)
mi_matriz[5,6]
```

* Acceder a una fila entera.
```{r}
mi_matriz[4,]
```

* Acceder a una columna entera.
```{r}
mi_matriz[,9]
```

* Acceder a un subconjunto de elementos de la matriz.
```{r}
mi_matriz[6:8,3:5]
```

### Operaciones con matrices

Al igual que pasaba con los vectores, podemos realizar operaciones aritm√©ticas b√°sicas con dos matrices, con los operadores `+`, `*`, `-`, `/`, etc. Del mismo modo, podemos realizar operaciones booleanas entre dos matrices.


#### Ejercicio

Define dos matrices y prueba el funcionamiento de los operadores aritm√©ticos entre dos matrices y entre un entero y una matriz.

```{r}

```


## Dataframes

Un ___Dataframe___ es una especie de _matriz_, en la que cada columna puede tener un tipo de dato diferente. Es muy parecido a una tabla. Por ejemplo, si queremos guardar datos sobre nuestros compa√±eros de clase podr√≠amos hacer un _Dataframe_:

```{r}
nombre <- c("Paloma", "Cristina", "Ana", "Braulio", "Teresa")
num_favorito <- c(25L, 26L, 27L, 28L, 29L)
dulce_favorito <- c("Cupcake","Pastel","Bizcocho","Bomb√≥n","Pastel")
altura <- c(1.70, 1.75, 1.72, 1.80, 1.76)
es_chica <- c(T,T,T,F,T)

amigos <- data.frame(nombre, num_favorito, dulce_favorito, altura, es_chica)
amigos
```


#### Ejercicio

__Crea tu propio DataFrame sobre la lista de la compra, con los siguientes atributos:__

* __Nombre del producto__
* __Precio__
* __Cantidad a comprar__
* __¬øLleva aceite de palma?__

__Una vez hayas definido tu Dataframe, exp√≥rtalo a un csv con la funci√≥n `write.csv` y vu√©lvelo a leer con la funci√≥n `read.csv`. Para ver la documentaci√≥n de estas dos funciones escribe `?nombre.de.la.funcion` en el int√©rprete de R.__

```{r}
```

### Vectorizando

Al igual que los vectores o las matrices, en los _Dataframe_ tambi√©n podemos seleccionar elementos usando el operador `[]` y el operador `$`.

Podemos seleccionar toda una columna:

```{r}
amigos$nombre
amigos["nombre"]
```

El operador `$` devuelve un vector mientras que el `[]` devuelve un _Dataframe_ con una √∫nica columna.

Podemos seleccionar varias columnas, seleccion·ndolas con un vector:

```{r}
amigos[,c("nombre","altura")]
```

E incluso, podemos seleccionar unas determinadas filas:

```{r}
amigos[seq(1,3), c("nombre", "altura")]
```

¬øY si queremos las columnas/filas que __cumplan una determinada condici√≥n__? Para ello, tendremos que usar la funci√≥n `subset`. Por ejemplo, queremos las personas cuyo postre favorito sean los _pasteles_.

```{r}
subset(x=amigos, subset=dulce_favorito=="Pastel", select=c(nombre, es_chica))
```

### Ejercicio
__Estudia la documentaci√≥n de `subset` y selecciona aquellos productos de tu lista de la compra que tengan un precio inferior a 5‚Ç¨ y que adem√°s no contengan aceite de palma.__

```{r}
```

### A√±adiendo y eliminando columnas o elementos

A√±adir o eliminar columnas a un _Dataframe_ es algo fundamental. Nos puede servir, entre otras cosas, para crear columnas que sean una combinaci√≥n de otras columnas. Para ello se usa la funci√≥n `cbind`:

```{r}
twitters <- c("unintendedbar","_musicalnote", "ana_valdi", "brau_vl", "TessaAlgarra")
cbind(amigos, twitters)
```

Para eliminar una columna, s√≥lo tenemos que establecerla a `NULL`:

```{r}
amigos$num_favorito <- NULL
amigos
```

Para eliminar una (o varias) fila, lo hacemos usando el operador `-`:

```{r}
amigos <- amigos[-c(1,2),]
amigos
```

#### Ejercicio

__Elimina todos los productos de tu cesta de la compra que contengan aceite de palma.__

```{r}
```


